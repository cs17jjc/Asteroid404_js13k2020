function aa(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}function ba(a){if(!(a instanceof Array)){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];a=b?b.call(a):{next:aa(a)};for(var d=[];!(b=a.next()).done;)d.push(b.value);a=d}return a}zzfx=function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return zzfxP(zzfxG.apply(null,ba(b)))};
zzfxP=function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];d=zzfxX.createBufferSource();var h=zzfxX.createBuffer(b.length,b[0].length,zzfxR);b.map(function(e,n){return h.getChannelData(n).set(e)});d.buffer=h;d.connect(zzfxX.destination);return d};
zzfxG=function(a,b,d,h,e,n,u,l,k,T,da,qa,Ba,fa,na,ra,Ja,sa,eb,P,ea,ta,ua,ja,Y,U,va,ha,Ra,fb,ub,gb,hb,R,ib,jb,V,Ca,Sa){a=void 0===a?1:a;b=void 0===b?.05:b;d=void 0===d?220:d;u=void 0===u?0:u;l=void 0===l?1:l;k=void 0===k?0:k;T=void 0===T?0:T;da=void 0===da?0:da;qa=void 0===qa?0:qa;Ba=void 0===Ba?0:Ba;fa=void 0===fa?0:fa;na=void 0===na?0:na;ra=void 0===ra?0:ra;sa=void 0===sa?1:sa;P=void 0===P?zzfxR:P;ea=void 0===ea?99+(void 0===h?0:h)*P:ea;ta=void 0===ta?(void 0===e?0:e)*P:ta;ua=void 0===ua?(void 0===
n?.1:n)*P:ua;ja=void 0===ja?(void 0===eb?0:eb)*P:ja;Y=void 0===Y?(void 0===Ja?0:Ja)*P:Y;U=void 0===U?2*Math.PI:U;va=void 0===va?function(kc){return 0<kc?1:-1}:va;ha=void 0===ha?ea+ja+ta+ua+Y:ha;Ra=void 0===Ra?k*=500*U/Math.pow(P,2):Ra;fb=void 0===fb?d*=(1+2*b*Math.random()-b)*U/P:fb;ub=void 0===ub?va(na)*U/4:ub;gb=void 0===gb?0:gb;hb=void 0===hb?0:hb;R=void 0===R?0:R;ib=void 0===ib?0:ib;jb=void 0===jb?0:jb;V=void 0===V?0:V;Ca=void 0===Ca?1:Ca;for(Sa=void 0===Sa?[]:Sa;R<ha;Sa[R++]=V)++jb>100*ra&&(jb=
0,V=gb*d*Math.sin(hb*na*U/P-ub),V=va(V=u?1<u?2<u?3<u?Math.sin(Math.pow(V%U,3)):Math.max(Math.min(Math.tan(V),1),-1):1-(2*V/U%2+2)%2:1-4*Math.abs(Math.round(V/U)-V/U):Math.sin(V))*Math.pow(Math.abs(V),l)*a*zzfxV*(R<ea?R/ea:R<ea+ja?1-(R-ea)/ja*(1-sa):R<ea+ja+ta?sa:R<ha-Y?(ha-R-Y)/ua*sa:0),V=Y?V/2+(Y>R?0:(R<ha-Y?1:(R-ha)/Y)*Sa[R-Y|0]/2):V),gb+=1-fa+1E9*(Math.sin(R)+1)%2*fa,hb+=1-fa+1E9*(Math.pow(Math.sin(R),2)+1)%2*fa,d+=k+=500*T*U/Math.pow(P,3),Ca&&++Ca>qa*P&&(d+=da*U/P,fb+=da*U/P,Ca=0),Ba&&++ib>Ba*
P&&(d=fb,k=Ra,ib=1,Ca=Ca||1);return Sa};zzfxV=.5;zzfxR=44100;zzfxX=new (top.AudioContext||webkitAudioContext);
zzfxM=function(a,b,d,h){for(var e,n,u,l,k,T,da,qa,Ba,fa,na,ra,Ja,sa,eb=0,P=[],ea=[],ta=[],ua=0,ja=0,Y=1,U={},va=zzfxR/(void 0===h?125:h)*60>>2;Y;ua++)P=[Y=qa=ra=0],d.map(function(ha,Ra){da=b[ha][ua]||[0,0,0];Y|=!!b[ha][ua];sa=ra+(b[ha][0].length-2-!qa)*va;Ja=Ra==d.length-1;n=2;for(l=ra;n<da.length+Ja;qa=++n){k=da[n];Ba=n==da.length+Ja-1&&Ja||fa!=(da[0]||0)|k|0;for(u=0;u<va&&qa;u++>va-99&&Ba?na+=(1>na)/99:0)T=(1-na)*P[eb++]/2||0,ea[l]=(ea[l]||0)-T*ja+T,ta[l]=(ta[l++]||0)+T*ja+T;k&&(na=k%1,ja=da[1]||
0,(k|=0)&&(P=U[[fa=da[eb=0]||0,k]]=U[[fa,k]]||(e=[].concat(ba(a[fa])),e[2]*=Math.pow(2,(k-12)/12),0<k?zzfxG.apply(null,ba(e)):[])))}ra=sa});return[ea,ta]};var ca=Array.from(Array(18).keys()).map(function(a){return 2==a?15:0}),ia=ca.slice();ia[14]=15;var ka=Array.from(Array(18).keys()).map(function(a){return 10==a?15:0==a?1:0}),la=Array.from(Array(18).keys()).map(function(a){return 0==a?2:0==a%4&&12!=a?15:0});
function ma(a){return Array.from(Array(18).keys()).map(function(b){return 0==b?3:[2,6,10,14].includes(b)?a+[.1,.5,.7][[2,6,10,14].indexOf(b)]:1==b?-.1:0})}
var oa=ma(18),pa=ma(22),wa=ma(24),xa=ma(30),ya=[8,9,10,11,8,9,10,11],za=[[[,0,86,,,,,.7,,,,.5,,6.7,1,.05],[.7,0,270,,,.12,3,1.65,-2,,,,,4.5,,.02],[.4,0,2200,,,.04,3,2,,,800,.02,,4.8,,.01,.1],[,0,130.81,,,1]],[[oa],[pa],[wa],[xa],[oa,ca,ka],[pa,ca,ka],[wa,ca,ka],[xa,ia,ka],[oa,ca,ka,la],[pa,ca,ka,la],[wa,ca,ka,la],[xa,ia,ka,la]],[0,1,2,3,0,1,2,3,4,5,6,7,4,5,6,7].concat(ya).concat(ya).concat(ya).concat(ya),120,{title:"",aa:""}];function Aa(a,b,d){this.x=a;this.y=b;this.z=d}
function Da(a,b,d){return a.x*b+a.y*d}
var Ea=[new Aa(1,1,0),new Aa(-1,1,0),new Aa(1,-1,0),new Aa(-1,-1,0),new Aa(1,0,1),new Aa(-1,0,1),new Aa(1,0,-1),new Aa(-1,0,-1),new Aa(0,1,1),new Aa(0,-1,1),new Aa(0,1,-1),new Aa(0,-1,-1)],Fa=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,
46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,
176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],Ga=Array(512),Ha=Array(512);function Ia(a){0<a&&1>a&&(a*=65536);a=Math.floor(a);256>a&&(a|=a<<8);for(var b=0;256>b;b++){var d=b&1?Fa[b]^a&255:Fa[b]^a>>8&255;Ga[b]=Ga[b+256]=d;Ha[b]=Ha[b+256]=Ea[d%12]}}Ia(0);function Ka(a,b,d){return(1-d)*a+d*b}
function La(a,b){var d=Math.floor(a),h=Math.floor(b);a-=d;b-=h;d&=255;h&=255;var e=a*a*a*(a*(6*a-15)+10);return Ka(Ka(Da(Ha[d+Ga[h]],a,b),Da(Ha[d+1+Ga[h]],a-1,b),e),Ka(Da(Ha[d+Ga[h+1]],a,b-1),Da(Ha[d+1+Ga[h+1]],a-1,b-1),e),b*b*b*(b*(6*b-15)+10))}function Ma(a,b,d){this.x=a;this.y=b;this.$=d;this.g=!1;this.j={type:"NONE"};this.a={type:"NONE"};this.isVisible=this.highlighted=!1;this.c={x:0,y:0};this.C=0}function Na(a,b,d,h){this.r=a;this.U=b;this.S=d;this.Y=h}
function Oa(a){return"#"+Pa(a.r)+Pa(a.U)+Pa(a.S)+Pa(a.Y)}function Qa(a,b){return new Na(Math.min(255,Math.trunc(a.r*b)),Math.min(255,Math.trunc(a.U*b)),Math.min(255,Math.trunc(a.S*b)),a.Y)}var Ta=document.getElementById("canv"),c=Ta.getContext("2d");c.imageSmoothingEnabled=!1;var f=[],g=[],Ua=[{x:1,y:0},{x:.5,y:.866025},{x:-.5,y:.866025},{x:-1,y:0},{x:-.5,y:-.866025},{x:.5,y:-.866025}],m=1;
function Va(a){var b=a.c;c.beginPath();var d=b.x+60*Ua[0].x,h=b.y+24*Ua[0].y;c.moveTo(d,h);for(var e=1;e<Ua.length;e++)d=b.x+60*Ua[e].x,h=b.y+24*Ua[e].y,c.lineTo(d,h);c.closePath();c.fill();c.stroke();if(a.isVisible&&"NONE"!=a.j.type){d=null;switch(a.j.type){case "IRON":d=new Na(165,42,42,255);break;case "COPPER":d=new Na(184,115,51,255);break;case "CARBON":d=new Na(18,18,18,255);break;case "LITHIUM":d=new Na(169,169,169,255);break;case "SILICON":d=new Na(0,153,204,255);break;case "ROCK":d=new Na(100,
100,100,255);break;case "PLUTONIUM":d=new Na(0,255,0,255)}c.lineWidth=3;c.fillStyle=Oa(d);c.strokeStyle=Oa(Qa(d,.4));a=a.j.lines;c.beginPath();c.moveTo(a[0].x+b.x,a[0].y+b.y);for(d=1;d<a.length;d++)c.lineTo(a[d].x+b.x,a[d].y+b.y);c.closePath();c.fill();c.stroke()}}
function Wa(){var a=.71*p,b=q,d=f.find(function(e){return e.g}),h=f.filter(function(e){return 11>=Math.abs(e.x-d.x)}).sort(function(e,n){return e.height-n.height}).sort(function(e,n){return e.y-n.y}).sort(function(e,n){return e.isVisible-n.isVisible});h.forEach(function(e){e.c.x=90*e.x+r/2-90*d.x;e.c.y=41.569219381653056*e.y+a;0!=e.x%2&&(e.c.y+=20.784609690826528);if(e.isVisible){e.c.y-=e.height;var n=new Na(Math.max(0,e.H.r*(1-e.C/10)),Math.min(255,e.H.U*(1+e.C/10)),Math.max(0,e.H.S*(1-e.C/10)),
255);c.strokeStyle=0==e.C?Oa(Qa(n,.2)):Oa(Qa(n,1.5));c.fillStyle=Oa(n);t.includes(e)&&(v?c.strokeStyle="#FFFF00":w&&(c.strokeStyle="#FF0000"),t.indexOf(e)==x&&(c.strokeStyle="#00FF00"));c.lineWidth=3;Va(e);switch(e.a.type){case "RADAR":c.drawImage(Xa,Math.trunc(e.c.x-Xa.width/2),Math.trunc(e.c.y-.9*Xa.height));break;case "CONSTRUCTOR":c.drawImage(Ya,Math.trunc(e.c.x-Ya.width/2),Math.trunc(e.c.y-.6*Ya.height));break;case "SOLAR":c.drawImage(Za,Math.trunc(e.c.x-Za.width/2),Math.trunc(e.c.y-.5*Za.height));
break;case "MINER":c.drawImage($a,Math.trunc(e.c.x-$a.width/2),Math.trunc(e.c.y-.8*$a.height));break;case "BATTERY":c.drawImage(ab,Math.trunc(e.c.x-ab.width/2),Math.trunc(e.c.y-.6*ab.height));break;case "RTG":c.drawImage(bb,Math.trunc(e.c.x-bb.width/2),Math.trunc(e.c.y-.6*bb.height));break;case "TELEDEPOT":c.drawImage(cb,Math.trunc(e.c.x-cb.width/2),Math.trunc(e.c.y-.6*cb.height));break;case "ROBOSHOP":c.drawImage(db,Math.trunc(e.c.x-db.width/2),Math.trunc(e.c.y-.6*db.height));break;case "GENERATOR":c.drawImage(kb,
Math.trunc(e.c.x-kb.width/2),Math.trunc(e.c.y-.6*kb.height))}}else c.strokeStyle="#000000",c.fillStyle="#AAAAAA",c.lineWidth=3,Va(e),c.fillStyle="#000000",c.font="24px Arial",c.textAlign="center",c.textBaseline="middle",y("404",e.c.x,e.c.y)});h=h.find(function(e){return e.g}).c;lb?c.drawImage(z,h.x-Math.trunc(z.width*m/2)+Math.trunc(b.x),Math.trunc(h.y-z.height*m/2-10)+Math.trunc(b.y),Math.trunc(z.width*m),Math.trunc(z.height*m)):c.drawImage(z,h.x-Math.trunc(z.width*m/2)+Math.trunc(b.x),Math.trunc(h.y-
z.height*m/2-10+4*Math.sin(Math.PI/180*A*180))+Math.trunc(b.y),Math.trunc(z.width*m),Math.trunc(z.height*m))}function mb(){var a=f.filter(function(b){return"RADAR"==b.a.type});console.log(a.length);f.forEach(function(b){a.some(function(d){return Math.abs(d.x-b.x)<=nb})?b.isVisible=!0:b.isVisible=!1})}
function ob(){var a=.05*r,b=.07*p;c.save();c.translate(a,b);c.strokeStyle="#A2A2A2";c.beginPath();c.moveTo(0,-25);c.lineTo(-25,25);c.lineTo(25,25);c.closePath();c.stroke();c.fillStyle="#FF0000";c.beginPath();c.arc(0,-25,12.5,0,2*Math.PI);c.fill();c.fillStyle="#FFF500";c.beginPath();c.arc(-25,25,12.5,0,2*Math.PI);c.fill();c.fillStyle="#0045FF";c.beginPath();c.arc(25,25,12.5,0,2*Math.PI);c.fill();c.restore()}
function pb(a,b,d,h){var e=.25*d;c.save();c.translate(a,b);c.fillStyle=Oa(new Na(255-255*h,255*h,0,255));c.fillRect(0,-d*h,e,d*h);c.strokeStyle="#FFFFFF";c.beginPath();c.moveTo(0,-d);c.lineTo(e,-d);c.lineTo(e,0);c.lineTo(0,0);c.closePath();c.stroke();c.restore()}
function qb(a,b){B=0;moving=!0;var d=f.find(function(e){return e.g}),h=f.find(function(e){return e.x==d.x+a&&e.y==d.y+b});null!=h&&(h.isVisible?Math.abs(h.height-d.height)<=5*rb?(d.g=!1,h.g=!0,q={x:d.c.x-h.c.x,y:d.c.y-h.c.y},C([D,.1,440,,,.07,,,,,50,.07])):g.push({text:"Incline too steep",time:0}):g.push({text:"Cannot enter unfound tile",time:0}))}function sb(a){"NONE"!=a.j.type&&(1==a.j.value?a.j={type:"NONE",value:0}:(--a.j.value,a.j.lines=tb(a.j.value,a.j.type)))}
function vb(a,b){a.a.type=b.type;var d=a.a;switch(b.type){case "RADAR":mb();break;case "CONSTRUCTOR":d.b=0;d.o=20;d.T=!1;d.K=0;d.N=!1;break;case "MINER":d.u=0;d.O=a.j.type;d.W=50;d.b=0;d.o=10;d.X=!1;d.M=0;break;case "BATTERY":d.b=0;d.o=20;d.L=0;d.P=!1;break;case "GENERATOR":d.I=0,d.Z=25,d.J=0,d.V=!1}--b.value;C([D,,191,,,.07,1,1.09,-5.4,,,,,.4,-.4,.3,,.7])}
function wb(){var a=t[x];switch(a.a.type){case "RADAR":var b=f.find(function(d){return d.g});1<=f.filter(function(d){return Math.abs(d.x-b.x)<=nb}).filter(function(d){return"RADAR"==d.a.type&&d!=a}).length?(xb(a.a.type),a.a={type:"NONE"},mb(),C([D,,400,,,.07,1,1.09,-5.4,,,,,.4,-.4,.3,,.7])):g.push({text:"No other radar in range",time:0});break;case "CONSTRUCTOR":1==a.a.N&&xb(a.a.D.product);xb(a.a.type);a.a={type:"NONE"};C([D,,400,,,.07,1,1.09,-5.4,,,,,.4,-.4,.3,,.7]);break;case "GENERATOR":yb("CARBON",
a.a.I);xb(a.a.type);a.a={type:"NONE"};C([D,,400,,,.07,1,1.09,-5.4,,,,,.4,-.4,.3,,.7]);break;default:xb(a.a.type),a.a={type:"NONE"},C([D,,400,,,.07,1,1.09,-5.4,,,,,.4,-.4,.3,,.7])}}function yb(a,b){var d=Math.min(zb,b),h=E.find(function(e){return e.type==a});null!=h?(h.value+d>zb&&(d=zb-h.value),h.value+=d):E.push({type:a,value:d});return d}function xb(a){var b=F.find(function(d){return d.type==a});null!=b?b.value+=1:F.push({type:a,value:1})}
function Pa(a){a=Math.trunc(a).toString(16);return 1==a.length?"0"+a:a}
function Ab(){var a=55+25*E.length+.05*p,b=[];b.unshift({x:0,y:.29*p});b.unshift({x:.09*r,y:.29*p});b.unshift({x:.1*r,y:p*(.29-.02)});b.unshift({x:.1*r,y:0});b.unshift({x:0,y:0});b.unshift({x:0,y:.48*p});b.unshift({x:.09*r,y:.48*p});b.unshift({x:.1*r,y:p*(.48-.02)});b.unshift({x:.1*r,y:.29*p});b.unshift({x:0,y:.29*p});b.unshift({x:0,y:0});b.unshift({x:.39*r,y:0});b.unshift({x:.42*r,y:.04*p});b.unshift({x:.58*r,y:.04*p});b.unshift({x:.61*r,y:0});b.unshift({x:.83*r,y:0});b.unshift({x:.83*r,y:a-.02*
p});b.unshift({x:.85*r,y:a});b.unshift({x:r,y:a});b.unshift({x:r,y:0});b.unshift({x:0,y:0});return b}
function Bb(a,b,d){var h=1-d;c.beginPath();c.moveTo(r*(d+.04),p*a);c.lineTo(r*(h-.04),p*a);c.lineTo(r*h,p*(a+.04));c.lineTo(r*h,p*(a+b-.04));c.lineTo(r*(h-.04),p*(a+b));c.lineTo(r*(d+.04),p*(a+b));c.lineTo(r*d,p*(a+b-.04));c.lineTo(r*d,p*(a+.04));c.closePath();c.fill();c.stroke();a+=.02;b-=.04;c.beginPath();c.moveTo(r*(d+.02+.04),p*a);c.lineTo(r*(h-.02-.04),p*a);c.lineTo(r*(h-.02),p*(a+.04));c.lineTo(r*(h-.02),p*(a+b-.04));c.lineTo(r*(h-.02-.04),p*(a+b));c.lineTo(r*(d+.02+.04),p*(a+b));c.lineTo(r*
(d+.02),p*(a+b-.04));c.lineTo(r*(d+.02),p*(a+.04));c.closePath();c.fill();c.stroke()}function Cb(a){return f.filter(function(b){var d=b.y-a.y;b=b.x-a.x;if(1==Math.abs(d)&&0==b||0==d&&1==Math.abs(b))return!0;if(0==a.x%2){if(-1==d&&1==Math.abs(b))return!0}else if(1==d&&1==Math.abs(b))return!0;return!1})}
function tb(a,b){switch(b){case "ROCK":var d=12;break;case "SILICON":d=5;break;case "LITHIUM":d=9;break;case "CARBON":d=15;break;default:d=7}for(var h=a/20,e=12*(Math.random()-.5)*h,n=12*(Math.random()-.5)*h,u=[],l=0;l<d;l++){var k=2*Math.PI/d*l;u.unshift({x:Math.max(-31,Math.min(31,e+(Math.cos(k)*h*60+15*Math.random()*h))),y:Math.max(-19,Math.min(19,n+(Math.sin(k)*h*24+15*Math.random()*h*.4)))})}return u}
function Db(a){var b=Eb;f=[];for(var d=0;5>d;d++)for(var h=0;500>h;h++)f.push(new Ma(h,d,a[h]));f.forEach(function(e){var n=0;switch(e.$){case 0:n=Math.abs((La(e.x/10,e.y/10)+1)/2*3);break;case 1:n=Math.abs((La(e.x/10,e.y/10)+1)/2*4);break;case 2:n=Math.abs((La(e.x/10,e.y/10)+1)/2*6);break;case 3:n=Math.abs((La(e.x/10,e.y/10)+1)/2*8);break;case 4:n=Math.abs((La(e.x/10,e.y/10)+1)/2*10)}n=Math.max(0,Math.trunc(n));e.height=5*n;e.H=b.find(function(u){return u.R.includes(n)}).H;2.5<Math.abs(240-e.x)&&
100*Math.random()>85+Math.min(15,Math.abs(240-e.x)/15)?Fb(e,"IRON",.6):25<Math.abs(240-e.x)&&90<100*Math.random()?Fb(e,"COPPER",.5):40<Math.abs(240-e.x)&&92<100*Math.random()?Fb(e,"CARBON",.6):60<Math.abs(240-e.x)&&96<100*Math.random()?Fb(e,"LITHIUM",.6):70<Math.abs(240-e.x)&&85<100*Math.random()?Fb(e,"SILICON",.5):120<Math.abs(240-e.x)&&85<100*Math.random()?(Fb(e,"PLUTONIUM",.7),Gb(e,4)):100*Math.random()>85+Math.min(15,Math.abs(240-e.x)/10)&&Fb(e,"ROCK",.9);80<Math.abs(240-e.x)&&95<100*Math.random()&&
Gb(e,5*Math.random())});f.find(function(e){return 240==e.x}).g=!0;f.filter(function(e){return"NONE"!=e.j.type}).forEach(function(e){return e.j.lines=tb(e.j.value,e.j.type)})}function Fb(a,b,d){var h=Math.max(10,Math.trunc(15*Math.random()));a.j={type:b,value:h};Cb(a).filter(function(){return Math.random()>d}).forEach(function(e){return e.j={type:b,value:Math.max(5,Math.trunc(h*Math.random()))}})}function Gb(a,b){a.C=b;Cb(a).forEach(function(d){return d.C=.8*b})}
var z=document.getElementById("rover"),Xa=document.getElementById("tower"),Ya=document.getElementById("constructor"),Za=document.getElementById("solar"),$a=document.getElementById("miner"),ab=document.getElementById("battery"),bb=document.getElementById("rtg"),cb=document.getElementById("teledepot"),db=document.getElementById("shop"),kb=document.getElementById("generator"),Hb="Resume;Main Menu;Save Game;Load Game;Mute Music;Mute Sound FX;Controls".split(";"),G=0,Ib=["New Game","Load Game","Mute Music",
"Mute Sound FX"],Jb=!0,D=0;function Kb(){zzfx.apply(null,[D,.01,593,,.03,0,1,2.04,.1,.1,50,.01,,-.1,,,.06,.96,.08]).start()}function Lb(){zzfx.apply(null,[D,0,604,,,.13,4,2.01,-.1,.2,50,,.01,,,.4,.05,.68,.05]).start()}
var Mb=[{product:"EXIT",items:[],b:0},{product:"RADAR",items:[{type:"IRON",value:18}],b:8}],Nb=[{type:"ROCK",A:1},{type:"IRON",A:5},{type:"COPPER",A:25},{type:"CARBON",A:50},{type:"LITHIUM",A:75},{type:"SILICON",A:100},{type:"PLUTONIUM",A:200}],Ob=Array.from(Array(21).keys()).map(function(a){var b=Math.trunc(a/3),d=Nb[b];return{type:d.type,A:d.A,s:[1,10,50][a-3*b]}});Ob.unshift({type:"EXIT",A:0,s:0});
var Pb=[{type:"EXIT",item:"EXIT",l:0,B:0,m:[]},{type:"CRAFT UPGRADES",item:"RESOURCE STORAGE",l:350,B:2,m:["Increases JMC\u2122 Craft resource","capacity by 20%"]},{type:"CRAFT UPGRADES",item:"BATTERY EFFICENCY",l:200,B:1.6,m:["Increases JMC\u2122 Craft battery capacity","by 25%"]},{type:"CRAFT UPGRADES",item:"CRAFT HEIGHT TOLERANCE",l:350,B:1.5,m:["Allows JMC\u2122 Craft to","move between tiles","with a larger height","difference."]},{type:"RECIPES",item:"CONSTRUCTOR",l:500,m:["Adds JMC\u2122 Constructor to",
"Constructor Database.","Constructors manufacture other","JMC\u2122 Buildings."]},{type:"RECIPES",item:"MINER",l:750,m:"Adds JMC\u2122 Miner to Constructor;Database.;JMC\u2122 Miners use energy to;gather resources 5 times;more efficent than;the JMC\u2122 Craft".split(";")},{type:"RECIPES",item:"GENERATOR",l:1025,m:["Adds JMC\u2122 Generator to Constructor","Database.","JMC\u2122 Generators create energy from","carbon."]},{type:"RECIPES",item:"SOLAR",l:1250,m:["Adds JMC\u2122 Solar Panel to","Constructor Database.",
"JMC\u2122 Solar Panels generate","fluctuating energy."]},{type:"RECIPES",item:"BATTERY",l:1650,m:["Adds JMC\u2122 Battery to","Constructor Database.","JMC\u2122 Batteries store","energy and release it","periodically."]},{type:"RECIPES",item:"RTG",l:2500,m:["Adds JMC\u2122 RTG to","Constructor Database.","JMC\u2122 RTGs generate","constant energy."]},{type:"BUILDING UPGRADES",item:"RADAR RADIUS",l:1E3,B:1.5,m:["Increases JMC\u2122 Radar uncover","distance by 3 tiles."]},{type:"BUILDING UPGRADES",
item:"CONSTRUCTOR SPEED",l:200,B:1.8,m:["Increases JMC\u2122 Constructor speed","by 30%"]},{type:"BUILDING UPGRADES",item:"CONSTRUCTOR TRANSMITTER",l:1850,m:["JMC\u2122 Constructor transmits","finished constructions to","JMC\u2122 Craft."]},{type:"BUILDING UPGRADES",item:"MINER SPEED",l:750,m:["Increases JMC\u2122 Miner speed","by 50%"]},{type:"BUILDING UPGRADES",item:"MINER TRANSMITTER",l:1985,m:["JMC\u2122 Miner transmits","mined resources to","JMC\u2122 Craft."]},{type:"BUILDING UPGRADES",item:"RTG OUTPUT",
l:250,B:1.8,m:["Increases JMC\u2122 RTG output","by 1."]},{type:"BUILDING UPGRADES",item:"SOLAR OUTPUT",l:750,B:1.4,m:["Increases JMC\u2122 Solar Panel output","by 1."]},{type:"BUILDING UPGRADES",item:"GENERATOR OUTPUT",l:500,B:2,m:["Increases JMC\u2122 Generator output","by 1."]}],H=Pb.slice(),Qb=Mb.slice(),Rb=1,I=50,Sb=50,lb=!1,Tb,Ub=0,Vb=[800,1500,2500,5E3,1E4,2E4,5E4],Wb=!1,Xb=!1,r=1280,p=720;Ta.width=r;Ta.height=p;Ta.style.width=Ta.width+"px";Ta.style.height=Ta.height+"px";
var J={i:!1,h:!1,left:!1,right:!1,f:!1,F:!1,remove:!1,v:!1,G:!1},K={i:!1,h:!1,left:!1,right:!1,f:!1,F:!1,remove:!1,v:!1,G:!1},q={x:0,y:0};f=[];g=[];var t=[],x=0,L=0,Yb=0,M=0,E,F,N=0,v=!1,w=!1,O=!1,Q=!1,S=!1,W=!1,Zb=!1,X,rb,zb,$b,ac,bc,cc,dc,ec,fc,gc,nb,A,hc,ic=0,jc=!1,lc=!1,B=0,mc=1,nc="Nominal",oc=zzfxM.apply(null,ba(za)),pc=zzfxP.apply(null,ba(oc));pc.loop=!0;pc.start();var qc=Array.from(Array(500).keys()).map(function(){return{x:2*Math.random()*r-r,y:2*Math.random()*p-p,r:3*Math.random()}});Ia(Math.random());
var Eb=[{R:[0,1,2],H:new Na(62,47,91,255)},{R:[3,4],H:new Na(190,184,235,255)},{R:[5,6,7],H:new Na(64,121,140,255)},{R:[8,9],H:new Na(115,251,211,255)}],rc=!1,sc=!1;function y(a,b,d){return c.fillText(a,b,d)}var tc=(new Date).getTime(),Z=0;
function uc(){c.fillStyle="#FFFFF0";c.save();c.translate(r/2,p/2);qc.forEach(function(a){c.beginPath();c.arc(a.x,a.y,a.r,0,2*Math.PI);c.fill()});c.restore();c.fillStyle="#FFFFFF";c.textAlign="center";c.textBaseline="middle";c.font="65px Tahoma";y("Planet 404",r/2,.1*p);1==K.i&&0==J.i&&(G=Math.max(0,G-1),C([]));1==K.h&&0==J.h&&(G=Math.min(Ib.length-1,G+1),C([]));if(1==K.f&&0==J.f){switch(Ib[G]){case "New Game":vc();D=.5;Jb=!1;G=0;sc=!0;break;case "Load Game":wc();D=.5;rc=!0;Jb=!1;G=0;break;case "Mute Music":pc.disconnect();
Ib[G]="Unmute Music";break;case "Mute Sound FX":D=0;Ib[G]="Unmute Sound FX";break;case "Unmute Music":pc.connect(zzfxX.destination);Ib[G]="Mute Music";break;case "Unmute Sound FX":D=1,Ib[G]="Mute Sound FX"}Kb()}c.font="40px Tahoma";Ib.forEach(function(a){var b=Ib.indexOf(a);if(G==b){var d=c.measureText(a).width;c.drawImage(z,Math.trunc(.45*r-.5*d-.5*z.width),Math.trunc(.3*p+80*b-.5*z.height));c.drawImage(z,Math.trunc(.55*r+.5*d-.5*z.width),Math.trunc(.3*p+80*b-.5*z.height));c.fillStyle="#FFFFFF"}else c.fillStyle=
"#AAAAAA";y(a,.5*r,.3*p+80*b)})}
function vc(){var a=Array.from(Array(500).keys()).map(function(b){return Math.min(4,Math.abs(Math.trunc(5*Math.cos(Math.abs(240-b)/250*Math.PI*2))))});Db(a);qb(0,0);F=[{type:"RADAR",value:1}];E=[];Tb=0;Qb=Mb.slice();H=Pb.slice();Zb=!1;I=X=50;rb=1;zb=50;ac=$b=1;bc=3;dc=cc=!1;ec=2.5;fc=5;nb=6;hc=A=0;Wb=!1;J={i:!1,h:!1,left:!1,right:!1,f:!1,F:!1,remove:!1,info:!1,v:!1,G:!1};K={i:!1,h:!1,left:!1,right:!1,f:!1,F:!1,remove:!1,info:!1,v:!1,G:!1};vb(f.find(function(b){return 240==b.x&&2==b.y}),{type:"RADAR",
value:1});vb(f.find(function(b){return 240==b.x&&0==b.y}),{type:"RTG",value:1});vb(f.find(function(b){return 239==b.x&&0==b.y}),{type:"CONSTRUCTOR",value:1});vb(f.find(function(b){return 243==b.x&&2==b.y}),{type:"TELEDEPOT",value:1});vb(f.find(function(b){return 237==b.x&&1==b.y}),{type:"ROBOSHOP",value:1})}
function xc(){c.fillStyle="#FFFFF0";c.save();c.translate(r/2,p/2);c.rotate(Math.PI/180*(360*hc+A));qc.forEach(function(d){c.beginPath();c.arc(d.x,d.y,d.r,0,2*Math.PI);c.fill()});c.restore();Wa();c.fillStyle="#FFFFFF";c.textAlign="center";if(!Q||lb||Wb)if(lb||Wb||Xb)if(lb){q.y=Ka(q.y,10,Z/1500);m=Ka(m,0,Z/1500);var b=Math.trunc(50-50*m);c.font=b+"px Arial";c.fillStyle="#FFFFFF";c.strokeStyle="#000000";c.textAlign="center";c.textBaseline="middle";y("You Died",r/2,.2*p);.4>m&&(y("Press E/Space to respawn",
r/2,.3*p),1==K.f&&0==J.f&&(I=X,E=[],F=[],f.find(function(d){return d.g}).g=!1,f.find(function(d){return 240==d.x}).g=!0,qb(0,0),lb=!1,m=1,q={x:0,y:0}))}else Wb?(q.y=Ka(q.y,10,Z/1500),m=Ka(m,0,Z/1500),b=Math.trunc(50-50*m),c.font=b+"px Arial",c.fillStyle="#FFFFFF",c.strokeStyle="#000000",c.textAlign="center",c.textBaseline="middle",y("Quota Failed",r/2,.2*p),f.forEach(function(d){return d.C=Math.min(6,d.C+Z/800)}),.4>m&&(y("Press E to return to main menu",r/2,.3*p),1==K.f&&0==J.f&&(Jb=!0,Wb=rc=Q=!1,
G=0,m=1)),.8<m?(c.fillStyle="#FFFFFF"+Pa(255-(1-m)/.2*255),c.beginPath(),c.arc(r/2,p/2,(1-m)/.2*r,0,2*Math.PI),c.fill()):(c.fillStyle="#FFFFFF"+Pa(m/.8*255),c.fillRect(0,0,r,p))):Xb&&(c.strokeStyle="#FFFFFF",c.fillStyle="#000000A",Bb(.05,.5,.2),b=r/2*.45,c.font="20px Arial",c.fillStyle="#FFFFFF",c.strokeStyle="#000000",c.textAlign="start",c.textBaseline="alphabetic",y("Congratulations, you have completed all JMC\u2122 Mining Initative quotas.",b,.2*p),y("Due to the costs of JMC\u2122 Craft recovery, you have been offered an",
b,25+.2*p),y("involutary position as cheif of planetary excavations and are forbidden",b,50+.2*p),y("from leaving this planet.",b,75+.2*p),c.textAlign="center",y("Thanks for playing!",r/2,.45*p),1.5<=A&&(y("Press E to enter endless mode",r/2,25+.45*p),1==K.f&&0==J.f&&(Zb=!0,Xb=!1)));else{f.filter(function(d){return d.isVisible&&"NONE"!=d.a.type}).forEach(function(d){return yc(d)});q.x=Ka(q.x,0,Z/150*Rb);q.y=Ka(q.y,0,Z/150*Rb);1==K.G&&0==J.G?Rb=1.8:0==K.G&&1==J.G&&(Rb=1);E=E.filter(function(d){return 0<
d.value});L=Math.min(Ob.filter(function(d){return E.some(function(h){return d.type==h.type&&h.value>=d.s})||"EXIT"==d.type}).length-1,L);F=F.filter(function(d){return 0<d.value});M=Math.min(H.length-1,M);!v||0!=F.length&&t.some(function(d){return"NONE"==d.a.type})||(x=0,v=!1,t=[]);w&&!t.some(function(d){return"NONE"!=d.a.type})&&(x=0,w=!1,t=[]);S&&0==Ob.filter(function(d){return E.some(function(h){return d.type==h.type&&h.value>=d.s})}).length&&(L=0,S=!1);var a=f.find(function(d){return d.g});Sb<
I?(jc=!1,nc="Charging"):S||W||["SOLAR","RTG","GENERATOR"].some(function(d){return d==a.a.type})?(jc=!1,nc="Paused"):I-=Z/1E3*(1+a.C);zc();Ac()}else if(c.textBaseline="middle",c.font="45px Tahoma",y("Paused",r/2,30),c.font="35px Tahoma",Hb.forEach(function(d){var h=Hb.indexOf(d);if(G==h){var e=c.measureText(d).width;c.drawImage(z,Math.trunc(.45*r-.5*e-.5*z.width),Math.trunc(.15*p+50*h-.5*z.height));c.drawImage(z,Math.trunc(.55*r+.5*e-.5*z.width),Math.trunc(.15*p+50*h-.5*z.height));c.fillStyle="#FFFFFF"}else c.fillStyle=
"#AAAAAA";y(d,.5*r,.15*p+50*h)}),0==K.i&&1==J.i&&(G=Math.max(0,G-1),C([])),0==K.h&&1==J.h&&(G=Math.min(Hb.length-1,G+1),C([])),1==K.v&&0==J.v&&(Q=!1),0==K.f&&1==J.f){switch(Hb[G]){case "Resume":Q=!1;break;case "Main Menu":Jb=!0;rc=Q=!1;G=0;break;case "Save Game":window.localStorage.setItem("Planet404_6473_DATA",JSON.stringify([f,A,hc,E,F,Tb,I,Qb,H,X,rb,zb,nb,$b,ac,bc,cc,dc,ec,fc,Zb]));g.push({text:"Game Saved",time:0});Q=!1;break;case "Load Game":wc();Q=!1;break;case "Mute Music":pc.disconnect();
Hb[G]="Unmute Music";break;case "Mute Sound FX":D=0;Hb[G]="Unmute Sound FX";break;case "Unmute Music":pc.connect(zzfxX.destination);Hb[G]="Mute Music";break;case "Unmute Sound FX":D=1,Hb[G]="Mute Sound FX"}Kb()}0>=I&&!lb&&(lb=!0,C([D,,160,.01,.2,.04,2,,-.1,.1,-100,.1]));Sb=I;lb||(A+=Z/800);359<=A&&(Tb>=Vb[hc]&&!Xb&&!Zb?(Tb-=Vb[hc],hc==Vb.length-1?(Xb=!0,C([D,0,220,,2,.08,1.5,,,,50,.07,.1,,,,.01])):C([D,0,160,,1,.04,2,,,,25,.07,.03,,,,.01])):Xb||Zb||Wb||(Wb=!0,C([D,,299,.01,.03,1.95,3,.1,.9,.6,,,,
.5,.9,.6,,.52,.06]),C([D,0,160,,1.25,.04,2,,,,-25,.25,.01,,,,.01])),hc+=1);A=359<=A?0:A}
function Ac(){!(1!=K.i||0!=J.i||v||w||O||Q||S||W)&&10>Math.abs(q.y)&&qb(0,-1);!(1!=K.h||0!=J.h||v||w||O||Q||S||W)&&10>Math.abs(q.y)&&qb(0,1);!(1!=K.i||1!=J.i||v||w||O||Q||S||W)&&10>Math.abs(q.y)&&qb(0,-1);!(1!=K.h||1!=J.h||v||w||O||Q||S||W)&&10>Math.abs(q.y)&&qb(0,1);1==K.i&&0==J.i&&v&&(N=Math.max(0,N-1),C([]));1==K.h&&0==J.h&&v&&(N=Math.max(0,Math.min(F.length-1,N+1)),C([]));1==K.i&&0==J.i&&O&&(N=Math.max(0,N-1),C([]));1==K.h&&0==J.h&&O&&(N=Math.max(0,Math.min(Qb.length-1,N+1)),C([]));1==K.i&&0==
J.i&&S&&(B=0,L=Math.max(0,L-1),C([]));1==K.h&&0==J.h&&S&&(B=0,L=Math.min(Ob.filter(function(b){return E.some(function(d){return b.type==d.type&&d.value>=b.s})||"EXIT"==b.type}).length-1,L+1),C([]));1==K.i&&0==J.i&&W&&(B=0,M=Math.max(0,M-1),C([]));1==K.h&&0==J.h&&W&&(B=0,M=Math.min(H.length-1,M+1),C([]));1==K.i&&1==J.i&&S&&(1<=B?(L=Math.max(0,L-1),B=0,C([])):B+=Z/100);1==K.h&&1==J.h&&S&&(1<=B?(L=Math.min(Ob.filter(function(b){return E.some(function(d){return b.type==d.type&&d.value>=b.s})||"EXIT"==
b.type}).length-1,L+1),B=0,C([])):B+=Z/100);1==K.i&&1==J.i&&W&&(1<=B?(M=Math.max(0,M-1),B=0,C([])):B+=Z/100);1==K.h&&1==J.h&&W&&(1<=B?(M=Math.min(H.length-1,M+1),B=0,C([])):B+=Z/100);!(1!=K.right||0!=J.right||v||w||Q||S||W)&&10>Math.abs(q.x)&&qb(1,0);!(1!=K.left||0!=J.left||v||w||Q||S||W)&&10>Math.abs(q.x)&&qb(-1,0);!(1!=K.right||1!=J.right||v||w||Q||S||W)&&10>Math.abs(q.x)&&qb(1,0);!(1!=K.left||1!=J.left||v||w||Q||S||W)&&10>Math.abs(q.x)&&qb(-1,0);1==K.right&&0==J.right&&(v||w)&&(x=x==t.length-1?
0:x+1);1==K.left&&0==J.left&&(v||w)&&(x=0==x?t.length-1:x-1);if(1==K.f&&0==J.f&&!v&&!w&&!Q){mc=1;B=0;var a=f.find(function(b){return b.g});"NONE"!=a.a.type?Bc(a):"NONE"!=a.j.type&&(0<yb(a.j.type,1)?(sb(a),C([D,0,320,.02-a.j.value/1E3,,0,4,.1,,,,,,,,.2,.01,0,.01])):g.push({text:"Resource full",time:0}))}a=f.find(function(b){return b.g});1==K.f&&1==J.f&&!v&&!w&&!Q&&1<=B?(B=0,a=f.find(function(b){return b.g}),"NONE"!=a.a.type?Bc(a):"NONE"!=a.j.type&&(0<yb(a.j.type,1)?(sb(a),C([D,0,320,.02-a.j.value/
1E3,,0,4,.1,,,,,,,,.2,.01,0,.01])):g.push({text:"Resource full",time:0}))):1!=K.f||1!=J.f||v||w||Q||(B+=Z/100*mc);1!=K.F||0!=J.F||v||w||O||Q||S||W?1==K.F&&0==J.F&&v&&(x=0,v=!1,t=[]):0<F.length?(N=0,v=!0,t=Cb(f.find(function(b){return b.g})).filter(function(b){return b.isVisible&&"NONE"==b.a.type}).sort(function(b,d){return b.y-d.y}).sort(function(b,d){return b.x-d.x}),t.forEach(function(b){return b.highlighted=!0})):g.push({text:"No Buildings",time:0});1!=K.remove||0!=J.remove||v||w||O||S||W||Q?1==
K.remove&&0==J.remove&&w&&(x=0,w=!1,t=[]):(w=!0,t=Cb(f.find(function(b){return b.g})).filter(function(b){return b.isVisible&&"NONE"!=b.a.type}).sort(function(b,d){return b.y-d.y}).sort(function(b,d){return b.x-d.x}),t.forEach(function(b){return b.highlighted=!0}));v&&1==K.f&&0==J.f&&t.some(function(b){return"NONE"==b.a.type})&&(vb(t[x],F[N]),F=F.filter(function(b){return 0<b.value}),t[x].highlighted=!1,t=t.filter(function(b){return b!=t[x]}),x=Math.min(t.length-1,x),N=Math.min(F.length-1,N));w&&1==
K.f&&0==J.f&&t.some(function(b){return"NONE"!=b.a.type})&&(wb(),t[x].highlighted=!1,t=t.filter(function(b){return b!=t[x]}),x=Math.min(t.length-1,x));1==K.v&&0==J.v&&(v||w||S||W||O)?(O=W=S=w=v=!1,t=[],S=N=x=0):1==K.v&&0==J.v&&(Q=!0)}
function wc(){O=W=S=w=v=!1;t=[];S=N=x=0;var a=JSON.parse(window.localStorage.getItem("Planet404_6473_DATA"));f=a[0];A=a[1];hc=a[2];E=a[3];F=a[4];Tb=a[5];I=a[6];Qb=a[7];H=a[8];X=a[9];rb=a[10];zb=a[11];nb=a[12];$b=a[13];ac=a[14];bc=a[15];cc=a[16];dc=a[17];ec=a[18];fc=a[19];Zb=a[20];qb(0,0)}
function Bc(a){switch(a.a.type){case "CONSTRUCTOR":if(O){var b=Object.assign({},Qb[N]);if("EXIT"!=b.product)if(a.a.b>=b.b){var d=b.items;d.filter(function(e){return E.some(function(n){return n.type==e.type&&n.value>=e.value})}).length==d.length?(a.a.D=b,E.forEach(function(e){var n=d.find(function(u){return u.type==e.type});null!=n&&(e.value-=n.value,g.push({text:"Used "+n.value+" units of "+e.type,time:0}))}),a.a.T=!0,a.a.b-=b.b,Kb()):(d.forEach(function(e){var n=E.find(function(u){return u.type==
e.type&&u.value<e.value});null!=n?g.push({text:e.value-n.value+" more "+e.type+" needed",time:0}):E.some(function(u){return u.type==e.type})||g.push({text:e.value+" more "+e.type+" needed",time:0})}),Lb())}else g.push({text:"Not enough energy",time:0});O=!1}else a.a.N?(xb(a.a.D.product),g.push({text:"Gained "+a.a.D.product,time:0}),a.a.N=!1,a.a.D=null,a.a.K=0,Kb()):null==a.a.D&&(O=!0,N=0);break;case "MINER":cc||(0==a.a.u?g.push({text:"Resource full",time:0}):(b=yb(a.a.O,a.a.u),0==b?(Lb(),g.push({text:"Resource full"+
b+a.a.O,time:0})):(a.a.u-=yb(a.a.O,a.a.u),g.push({text:"Gained "+b+a.a.O,time:0}),Kb())));break;case "TELEDEPOT":if(S){var h=Ob.filter(function(e){return E.some(function(n){return e.type==n.type&&n.value>=e.s})||"EXIT"==e.type})[L];"EXIT"!=h.type?(a=E.find(function(e){return e.type==h.type}),a.value>=h.s?(a.value-=h.s,Tb+=h.s*h.A,C([D,.01,287,.11,,0,3,.01,,,198,.09,,,,,.06,.5])):g.push({text:"Cannot sell "+h.s+" of "+h.type,time:0})):(L=0,S=!1)}else L=0,S=!0;break;case "ROBOSHOP":if(W)if("EXIT"!=
H[M].type)if(Tb>=H[M].l){Tb-=H[M].l;switch(H[M].item){case "RESOURCE STORAGE":zb=Math.round(1.2*zb);break;case "BATTERY EFFICENCY":X=Math.round(1.25*X);break;case "CRAFT HEIGHT TOLERANCE":rb+=1;break;case "CONSTRUCTOR SPEED":ac*=1.3;break;case "CONSTRUCTOR TRANSMITTER":dc=!0;H=H.filter(function(e){return"CONSTRUCTOR TRANSMITTER"!=e.item});break;case "MINER SPEED":bc*=1.5;break;case "MINER TRANSMITTER":cc=!0;H=H.filter(function(e){return"MINER TRANSMITTER"!=e.item});break;case "RTG OUTPUT":fc+=1;break;
case "SOALR OUTPUT":$b+=1;break;case "GENERATOR OUTPUT":gc+=1;break;case "RADAR RADIUS":nb+=3;mb();break;case "CONSTRUCTOR":Qb.push({product:"CONSTRUCTOR",items:[{type:"IRON",value:10},{type:"COPPER",value:15}],b:4});H=H.filter(function(e){return"CONSTRUCTOR"!=e.item});break;case "MINER":Qb.push({product:"MINER",items:[{type:"IRON",value:10},{type:"COPPER",value:15},{type:"CARBON",value:8}],b:4});H=H.filter(function(e){return"MINER"!=e.item});break;case "GENERATOR":Qb.push({product:"GENERATOR",items:[{type:"IRON",
value:20},{type:"COPPER",value:25},{type:"ROCK",value:15}],b:5});H=H.filter(function(e){return"GENERATOR"!=e.item});break;case "BATTERY":Qb.push({product:"BATTERY",items:[{type:"IRON",value:10},{type:"COPPER",value:10},{type:"LITHIUM",value:5}],b:8});H=H.filter(function(e){return"BATTERY"!=e.item});break;case "SOLAR":Qb.push({product:"SOLAR",items:[{type:"COPPER",value:5},{type:"SILICON",value:10}],b:10});H=H.filter(function(e){return"SOLAR"!=e.item});break;case "RTG":Qb.push({product:"RTG",items:[{type:"IRON",
value:25},{type:"COPPER",value:25},{type:"PLUTONIUM",value:10}],b:10}),H=H.filter(function(e){return"RTG"!=e.item})}null!=H[M].B&&(H[M].l=Math.round(H[M].l*H[M].B));Kb()}else g.push({text:"Cannot afford "+H[M].item,time:0}),Lb();else W=!1;else W=!0;break;case "GENERATOR":b=E.find(function(e){return"CARBON"==e.type}),null!=b?a.a.I<a.a.Z?(a.a.I+=1,--b.value,Kb()):g.push({text:"Generator is full",time:0}):(g.push({text:"No available carbon",time:0}),Lb())}}
function zc(){var a=.12*p;jc?1<=ic&&(C([D,0,500,.2,,0,1,.5,,,50,.12,,,,,,,.01]),lc=!lc,ic=0):lc=!1;c.strokeStyle=lc?"#FF0000":"#FFFFFF";c.fillStyle="#000000AA";var b=Ab();c.beginPath();for(var d=0;d<b.length;d++)0==d?c.moveTo(b[d].x,b[d].y):c.lineTo(b[d].x,b[d].y);c.closePath();c.fill();c.stroke();c.font="15px Arial";c.fillStyle="#FFFFFF";c.textAlign="start";g=g.slice(-3,5);g=g.filter(function(l){return 2E3>l.time});var h=25*g.length;g.forEach(function(l){y(l.text,.01*r,.42*p+150-h+25*g.indexOf(l));
l.time+=Z});c.textAlign="center";c.textBaseline="middle";c.font="25px Arial";y("Inventory",.92*r,30);c.font="15px Arial";E.forEach(function(l){y(l.value+"/"+zb+" units of "+l.type,.92*r,80+25*E.indexOf(l))});y("Sol: "+(hc+1)+" Planet Rotation: "+A.toFixed(0)+"\u00b0",r/2,15);v||w||O||S||W||!(8>=A||352<=A)||(c.fillStyle="#000000AA",3>A||357<=A?(c.strokeStyle="#FFFFFF",Bb(.05,.14,.39),c.font="30px Tahoma",c.fillStyle="#FFFFFF",y("Sol "+(hc+1)+"/7",r/2,a)):8>=A?(b=Pa(255-(A-3)/5*255),c.strokeStyle="#FFFFFF"+
b,Bb(.05,.14,.39),c.font="30px Tahoma",c.fillStyle="#FFFFFF"+b,y("Sol "+(hc+1)+"/7",r/2,a)):352<=A&&(b=Pa((A-352)/5*255),c.strokeStyle="#FFFFFF"+b,Bb(.05,.14,.39),c.font="30px Tahoma",c.fillStyle="#FFFFFF"+b,y("Sol "+(hc+1)+"/7",r/2,a)));c.strokeStyle="#FFFFFF";if(v){c.fillStyle="#000000AA";Bb(.05,.5,.4);c.font="30px Tahoma";c.fillStyle="#FFFFFF";y("Build Mode",r/2,a);c.font="20px Tahoma";var e=5,n=F.filter(function(l){return Math.abs(F.indexOf(l)-N)<e+Math.max(0,e-1-N)});n.forEach(function(l){var k=
F.indexOf(l);c.fillStyle="#AAAAAA";N==k&&(c.fillStyle="#FFFFFF");"EXIT"!=l.type?y(l.value+" "+l.type,r/2,a+40+25*n.indexOf(l)):y(l.type,r/2,a+40+25*n.indexOf(l))})}w&&(c.fillStyle="000000AA",Bb(.05,.14,.39),c.fillStyle="#FFFFFF",c.font="30px Tahoma",y("Remove Mode",r/2,a));O&&(c.fillStyle="#000000AA",Bb(.05,.5,.3),c.fillStyle="#FFFFFF",c.beginPath(),c.moveTo(.5*r,.07*p),c.lineTo(.5*r,.53*p),c.stroke(),c.font="30px Tahoma",y("Set Recipe:",.4*r,a+.01*r),c.font="20px Tahoma",e=5,n=Qb.filter(function(l){return Math.abs(Qb.indexOf(l)-
N)<e+Math.max(0,e-1-N)}),n.forEach(function(l){var k=Qb.indexOf(l);c.fillStyle="#AAAAAA";N==k&&(c.fillStyle="#FFFFFF");"EXIT"!=l.product&&(N==k&&(c.font="25px Tahoma",l.items.forEach(function(T){return y(T.value+" "+T.type,.59*r,a+.01*r+40+25*l.items.indexOf(T))}),y(l.b+" ENERGY",.59*r,a+.01*r+40+25*l.items.length)),c.font="20px Tahoma");y(l.product,.4*r,a+.01*r+40+25*n.indexOf(l))}));if(S){c.fillStyle="#000000AA";Bb(.05,.5,.4);c.fillStyle="#FFFFFF";c.font="30px Tahoma";y("Sell Mode",r/2,a);c.font=
"20px Tahoma";e=5;var u=Ob.filter(function(l){return E.some(function(k){return l.type==k.type&&k.value>=l.s})||"EXIT"==l.type});n=u.filter(function(l){return Math.abs(u.indexOf(l)-L)<e+Math.max(0,e-1-L)});n.forEach(function(l){var k=u.indexOf(l);c.fillStyle="#AAAAAA";L==k&&(c.fillStyle="#FFFFFF");"EXIT"!=l.type?y(l.s+" "+l.type+" : \u20bf"+l.A*l.s,r/2,a+40+25*n.indexOf(l)):y(l.type,r/2,a+40+25*n.indexOf(l))})}W&&(c.fillStyle="#000000AA",Bb(.05,.5,.2),c.fillStyle="#FFFFFF",c.beginPath(),c.moveTo(.5*
r,.07*p),c.lineTo(.5*r,.53*p),c.stroke(),"EXIT"!=H[M].type&&(c.beginPath(),c.moveTo(.5*r,.46*p),c.lineTo(.78*r,.46*p),c.stroke()),c.font="30px Tahoma",y("Buy Mode",.36*r,a),c.font="20px Tahoma",e=5,n=H.filter(function(l){return Math.abs(H.indexOf(l)-M)<e+Math.max(0,e-1-M)}),n.forEach(function(l){var k=H.indexOf(l);c.fillStyle="#AAAAAA";M==k&&(c.fillStyle="#FFFFFF");c.textAlign="center";c.textBaseline="middle";"EXIT"!=l.type?(y(l.item,.36*r,a+20+40+25*n.indexOf(l)),M==k&&(y(l.type,.65*r,a+20),y("\u20bf"+
Yb.toLocaleString("en-US",{maximumFractionDigits:0}),.64*r,.495*p),c.textAlign="start",l.m.forEach(function(T){return y(T,.51*r,a+20+40+25*l.m.indexOf(T))}))):y(l.type,.36*r,a+20+40+25*n.indexOf(l))}),Yb=Ka(H[M].l,Yb,Z/80));c.textAlign="center";c.textBaseline="middle";c.fillStyle="#FFFFFF";c.font="20px Tahoma";y("JMC",.05*r,.14*p);ob();Zb?(y("Endless",.05*r,.22*p),y("Mode",.05*r,25+.22*p)):y("Daily Quota:",.05*r,.22*p);c.font="25px Tahoma";y("\u20bf"+Ub.toLocaleString("en-US",{maximumFractionDigits:0}),
.05*r,.18*p);Ub=Ka(Tb,Ub,Z/100);Zb||(Tb>=Vb[hc]?c.fillStyle="#00FF00":300<A&&0==Math.trunc(A)%2&&(c.fillStyle="#FF0000"),y("\u20bf"+Vb[hc].toLocaleString("en-US",{maximumFractionDigits:0}),.05*r,.26*p));c.fillStyle="#FFFFFF";c.font="15px Tahoma";pb(.02*r,.45*p,100,I/X);lc&&(c.fillStyle="#FF0000");y("Battery",.07*r,.32*p);y("Status:",.07*r,.34*p);b=I/X;c.font="12px Tahoma";y(nc,.07*r,.36*p);c.fillStyle="#FFFFFF";0<f.find(function(l){return l.g}).C&&(c.font="50px Tahoma",y("\u2622",.07*r,p*(.45-.032)));
.6<b?(nc="Nominal",jc=!1):.4<b?(nc="Satisfactory",jc=!1):.3<b?(nc="Low",jc=!1,ic=0):15>=I&&10<I?(nc="Very Low",jc=!0,ic+=Z/400):10>=I&&5<I?(nc="Critical",jc=!0,ic+=Z/150):5>=I&&(nc="Deadly",jc=!0,ic+=Z/50)}
function yc(a){var b=.85*r,d=.45*p;c.lineWidth=2;c.textAlign="start";c.textBaseline="alphabetic";c.font="15px Arial";switch(a.a.type){case "SOLAR":var h=$b*Math.max(.25,Math.sin(A*Math.PI/180));if(a.g&&I<X)I=Math.min(X,I+Z/1E3*h);else{var e=Cb(a).filter(function(k){return null!=k.a.b}).filter(function(k){return k.a.b!=k.a.o}),n=h/e.length*(Z/1E3);e.forEach(function(k){k.a.b=k.a.b+n>=k.a.o?k.a.o:k.a.b+n})}a.g&&!Q&&(y("\u26a1",b+9,d+20),pb(b,d+40+.08*p,.1*p,Math.min(1,h/$b)));break;case "CONSTRUCTOR":null!=
a.a.D&&a.a.T&&(a.a.K+=Z/1E4*ac,1<=a.a.K&&(dc?(xb(a.a.D.product),a.a.D=null,playerTile.a.K=0):a.a.N=!0,a.a.T=!1));a.g&&!Q&&(y("Recipe: "+(void 0!=a.a.D?a.a.D.product:"None"),b,d),y("\u26a1",b+9,d+20),a.a.N&&(c.fillStyle="#00FF00"),y("%",19+b+.025*p,d+20),pb(b,d+40+.08*p,.1*p,Math.min(1,a.a.b/a.a.o)),pb(10+b+.025*p,d+40+.08*p,.1*p,Math.min(1,a.a.K)));break;case "MINER":a.a.X?(a.a.M+=Z/25E3*bc,1<=a.a.M&&(a.a.u=Math.min(a.a.W,a.a.u+5),sb(a),a.a.X=!1,a.a.M=0)):1<=a.a.b&&"NONE"!=a.j.type&&a.a.u<a.a.W&&
(--a.a.b,a.a.X=!0);cc&&(a.a.u-=yb(a.a.O,a.a.u));a.g&&!Q&&(y("\u26a1",b+9,d+20),y("%",19+b+.025*p,d+20),y("\u2a06",29+b+.05*p,d+20),pb(b,d+40+.08*p,.1*p,Math.min(1,a.a.b/a.a.o)),pb(10+b+.025*p,d+40+.08*p,.1*p,Math.min(1,a.a.M)),pb(20+b+.05*p,d+40+.08*p,.1*p,Math.min(1,a.a.u/a.a.W)));break;case "BATTERY":e=Cb(a).filter(function(k){return null!=k.a.b}).filter(function(k){return k.a.b!=k.a.o});var u=e.filter(function(k){return"BATTERY"==k.a.type}).filter(function(k){return k.a.b+1<a.a.b}),l=e.filter(function(k){return"BATTERY"!=
k.a.type});a.a.P?(a.a.L+=Z/1E4*ec,0==e.length&&(a.a.L=0,a.a.P=!1,a.a.b=Math.min(a.a.b+1,a.a.o)),1<=a.a.L&&(a.a.L=0,a.a.P=!1,0<l.length?l.forEach(function(k){return k.a.b+=1/l.length}):0<u.length&&u.forEach(function(k){return k.a.b+=1/u.length}))):1<=a.a.b&&(0<l.length||0<u.length)&&(--a.a.b,a.a.P=!0);a.g&&!Q&&(y("\u26a1",b+9,d+20),y("%",19+b+.025*p,d+20),pb(b,d+40+.08*p,.1*p,Math.min(1,a.a.b/a.a.o)),pb(10+b+.025*p,d+40+.08*p,.1*p,Math.min(1,a.a.L)));break;case "RTG":a.g&&I<X?I=Math.min(X,I+Z/1E3*
fc):(e=Cb(a).filter(function(k){return null!=k.a.b}).filter(function(k){return k.a.b!=k.a.o}),n=fc/e.length*(Z/1E3),e.forEach(function(k){k.a.b=k.a.b+n>=k.a.o?k.a.o:k.a.b+n}));break;case "GENERATOR":1<=a.a.J?(a.g&&I<X?I=Math.min(X,I+gc):(e=Cb(a).filter(function(k){return null!=k.a.b}).filter(function(k){return k.a.b!=k.a.o}),n=gc/e.length,e.forEach(function(k){k.a.b=k.a.b+n>=k.a.o?k.a.o:k.a.b+n})),a.a.J=0,a.a.V=!1):1>a.a.J&&a.a.V?a.a.J+=Z/800:1<=a.a.I&&(a.g&&I<X||0<Cb(a).filter(function(k){return null!=
k.a.b}).filter(function(k){return k.a.b!=k.a.o}).length)&&(--a.a.I,a.a.J=0,a.a.V=!0),a.g&&(y("\u2a06",b+9,d+20),y("%",19+b+.025*p,d+20),pb(b,d+40+.08*p,.1*p,Math.min(1,a.a.I/a.a.Z)),pb(10+b+.025*p,d+40+.08*p,.1*p,Math.min(1,a.a.J)))}}
document.addEventListener("keydown",function(a){switch(a.keyCode){case 87:K.i=!0;break;case 83:K.h=!0;break;case 68:K.right=!0;break;case 65:K.left=!0;break;case 69:K.f=!0;break;case 32:K.f=!0;break;case 66:K.F=!0;break;case 82:K.remove=!0;break;case 27:K.v=!0;break;case 16:K.G=!0}});
document.addEventListener("keyup",function(a){switch(a.keyCode){case 87:K.i=!1;break;case 83:K.h=!1;break;case 68:K.right=!1;break;case 65:K.left=!1;break;case 69:K.f=!1;break;case 32:K.f=!1;break;case 66:K.F=!1;break;case 82:K.remove=!1;break;case 27:K.v=!1;break;case 16:K.G=!1}});function C(a){zzfx.apply(null,ba(a)).start()}
setInterval(function(){Z=Q?0:(new Date).getTime()-tc;c.fillStyle="#000000";c.fillRect(0,0,Ta.clientWidth,Ta.clientHeight);Jb&&uc();if(sc){c.strokeStyle="#FFFFFF";c.fillStyle="#000000AA";Bb(.02,.9,.1);var a=.13*r,b=.11*p;c.font="22px Arial";c.fillStyle="#FFFFFF";c.strokeStyle="#000000";c.textAlign="start";c.textBaseline="alphabetic";y("Welcome, valued Roboemployee, to the JMC\u2122 Autonomous Mining Initative.",a,b);y("Over the course of the next 7 solar rotations your mining effectiveness will be assesed by",
a,50+b);y("your ability to meet daily monetary quotas.",a,75+b);y("Quotas can be met by ",a,100+b);var d=c.measureText("Quotas can be met by ").width;c.fillStyle="#00FF00";y("Mining (E/Space)",a+d,100+b);d+=c.measureText("Mining (E/Space)").width;c.fillStyle="#FFFFFF";y(" and selling resources to the TELEDEPOT.",a+d,100+b);y("Failure to complete these quotas will result in immediate nuclear vapourisation.",a,150+b);y("JMC\u2122 Operations & Managment regrets to inform you that terrain maps",a,200+
b);y("for JMC\u2122 Planet 404 have been lost, you are required to use your",a,225+b);y("JMC\u2122 Craft's ",a,250+b);d=c.measureText("JMC\u2122 Craft's ").width;c.fillStyle="#00FF00";y("Build Mode (B) & Remove Mode (R)",a+d,250+b);d+=c.measureText("Build Mode (B) & Remove Mode (R)").width;c.fillStyle="#FFFFFF";y(" to place RADARs and uncover more terrain.",a+d,250+b);y("The CONSTRUCTOR creates buildings, such as extra RADARs, from resources and energy.",a,300+b);y("Your JMC\u2122 Craft has a limited battery capacity, failure to charge the battery",
a,325+b);y("will result in loss of resources and buildings in possesion.",a,350+b);y("An RTG has been made available to provide energy and charge your JMC\u2122 Craft.",a,375+b);y("A ROBOSHOP has been made available for you to purchase upgrades to aid effectiveness.",a,400+b);c.textAlign="center";y("WASD to move, left shift to sprint, E/Space to interact.",r/2,450+b);y("Good Luck.",r/2,.82*p);y("Press E/Space to start",r/2,25+.85*p);1==K.f&&0==J.f&&(sc=!1,rc=!0)}rc&&xc();J=Object.assign({},K);tc=
(new Date).getTime()},50);